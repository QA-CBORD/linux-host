<div class="conversations" [ngClass]="{ 'conversations--auto-height': !isLoading }">
  <ion-list class="conversations__sender-list" *ngIf="lastTwoMessagesArray.length && !isLoading">
    <ng-container *ngFor="let conversation of lastTwoMessagesArray">
      <ion-item *ngFor="let message of conversation.messages" class="conversations__sender-item" lines="none">
        <ion-avatar *ngIf="showTextAvatar" class="conversations__sender-avatar-wrapper">
          <div
            class="conversations__sender-avatar-text"
            [ngStyle]="{ background: getAvatarBackgroundColor(conversation.groupName) }"
          >
            {{ getConversationGroupInitial(conversation.groupName) }}
          </div>
        </ion-avatar>
        <div class="conversations__sender-info">
          <div class="conversations__sender-name-time-wrapper">
            <div
              class="conversations__sender-name"
              [ngClass]="{
                'conversations__sender-name--unread': !message.read_date && message.sender.type !== 'patron'
              }"
            >
              {{ conversation.groupName }}
            </div>
            <div class="conversations__sender-recent-time">{{ message | messageDate }}</div>
          </div>
          <div class="conversations__sender-recent-message">
            <span *ngIf="message.sender.type === 'patron'">You: </span>{{ message.body }}
          </div>
        </div>
        <ng-container *ngIf="!message.read_date && message.sender.type !== 'patron'">
          <div class="conversations__sender-message-indicator-wrapper">
            <span class="indicator"></span>
          </div>
        </ng-container>
      </ion-item>
    </ng-container>
  </ion-list>

  <ion-list *ngIf="isLoading">
    <ion-item *ngFor="let a of conversationSkeletonArray">
      <ion-label>
        <div class="conversations__skeleton-conversation">
          <p>
            <ion-skeleton-text animated class="conversations__skeleton-avatar" slot="start"></ion-skeleton-text>
          </p>
          <p class="conversations__skeleton-body">
            <ion-skeleton-text class="conversations__skeleton-name" animated></ion-skeleton-text>
            <ion-skeleton-text class="conversations__skeleton-time" animated></ion-skeleton-text>
            <ion-skeleton-text class="conversations__skeleton-msg" animated></ion-skeleton-text>
          </p>
        </div>
      </ion-label>
    </ion-item>
  </ion-list>
</div>
