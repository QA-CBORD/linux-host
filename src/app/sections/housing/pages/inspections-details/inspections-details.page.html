<ng-container *ngIf="(inspectionDetails$ | async) as inspectionDetails">
  <st-forms-header [showSave]="!(status > 1)" (onSave)="save(inspectionDetails)">
  </st-forms-header>
  <ion-content class="ion-padding inspection-details__content" #content>
    <h2 class="inspection-details__title">{{inspectionDetails.formDefinition.applicationTitle}}</h2>
    <st-housing-tabs (onTabSelected)="changeView($event)">
      <st-housing-tab *ngFor="let room of inspectionDetails.sections" [tabTitle]="room.name"></st-housing-tab>
    </st-housing-tabs>

    <div [ngSwitch]="section" class="inspection-details__card">
      <ng-container *ngFor="let room of inspectionDetails.sections">
        <ng-container *ngSwitchCase="room.name">
          <ion-card *ngFor="let item of room.items;let i = index;" [disabled]="status > 1">
            <ion-item lines="none">
              <ion-label>
                <h1>{{item.name}}</h1>
              </ion-label>
            </ion-item>
            <ion-item lines="none">
              <ion-select class="selectorCondition" [(ngModel)]="item.residentConditionKey"
                placeholder="select a condition">
                <ion-select-option *ngFor="let condition of conditions"
                  [value]="+condition.value">{{condition.label}}</ion-select-option>
              </ion-select>
            </ion-item>
            <ion-item lines="none" *ngIf="item.staffConditionKey">
              <ion-label class="staffCondition">
                The staff rated this itemâ€™s condition as
                <span class="__color">{{getConditionStaff(item.staffConditionKey)}}</span>
              </ion-label>
            </ion-item>
            <ion-item class="comments" lines="none">
              <ion-label position="stacked">Add comments</ion-label>
              <ion-textarea (onfocus)="true" class="textarea__control" label="Add comments" [(ngModel)]="item.comments">
              </ion-textarea>
            </ion-item>
          </ion-card>
        </ng-container>
      </ng-container>
      <st-stepper-footer>
        <div>
          <h2 class="inspection-details__title">Room Inspections</h2>
          <ion-label color="medium">
            {{ countItemsLeft(inspectionDetails) | i18nPlural:roomsMapping}}
          </ion-label>
        </div>
        <ion-button class="btn btn-submit" mode="ios" type="submit" item-right
        [color]="countItemsLeft(inspectionDetails) > 0 || isSubmitted && 'light'"
          (click)="submitInspection(inspectionDetails)"
          [disabled]="countItemsLeft(inspectionDetails) > 0 || isSubmitted">
          Submit
        </ion-button>
      </st-stepper-footer>
    </div>
  </ion-content>
</ng-container>