<ion-header class="login-header" no-border>
  <ion-toolbar mode="ios" class="ion-color" [style.background-color]="nativeHeaderBg$ | async">
    <ion-buttons slot="start">
      <ion-back-button
        [defaultHref]="defaultBackUrl"
        class="login-header__back-btn"
        color="light"
        text="Back"
        icon="ios-arrow-back"
        mode="ios"
      ></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content class="login" scrollY="false">
  <div
    class="login__institution"
    [ngStyle]="{ backgroundColor: nativeHeaderBg$ | async}"
    *ngIf="{ photo: institutionPhoto$ | async, name: institutionName$ | async } as instutionValues"
  >
    <img
      *ngIf="instutionValues.photo"
      class="login__institution-logo"
      [src]="instutionValues.photo"
      alt="institution logo"
    />
    <ion-text *ngIf="instutionValues.name && !instutionValues.photo" class="login__institution-name">
      {{ instutionValues.name }}
    </ion-text>
  </div>
  <div class="login__form-wrapper">
    <form class="login__form" [formGroup]="loginForm">
      <div *ngVar="{ isLDAP: authTypeLDAP$ | async, isInstructions: loginInstructions$ | async } as authInfo">
        <ion-card *ngIf="authInfo.isLDAP && authInfo.isInstructions" class="login__LDAP-message">
          <ion-card-content>
            <div [innerHTML]="authInfo.isInstructions"></div>
          </ion-card-content>
        </ion-card>
      </div>
      <st-input-floating-label
        [label]="placeholderOfUsername$ | async"
        [formControlName]="controlsNames.username"
        [control]="username"
        [isError]="username.invalid && username.touched"
        type="email"
        idd="username"
        [stFocusNext]="inputPassword"
        tabindex="0"
      >
      </st-input-floating-label>
      <br />
      <st-input-floating-label
        #inputPassword
        [label]="'Password'"
        [formControlName]="controlsNames.password"
        [control]="password"
        [isError]="password.invalid && password.touched"
        type="password"
        idd="password"
        enterkeyhint="go"
        (keyup.enter)="authenticateUser(loginForm)"
        tabindex="0"
      >
      </st-input-floating-label>
      <ng-container
        *ngVar="{ isHosted: authTypeHosted$ | async, isSignupEnabled: signupEnabled$ | async } as authValues"
      >
        <!--using visibility instead of ngIf to maintain UI formatting-->
        <div [style.visibility]="authValues.isHosted ? 'visible' : 'hidden'" class="login__form-password">
          <a class="login__form-password-forgot" (click)="redirectToForgotPassword()" tabindex="2">Forgot password?</a>
        </div>
        <div class="login__form-btns">
          <st-button
            *ngIf="authValues.isHosted && authValues.isSignupEnabled"
            buttonModifier="border-only-rectangle"
            class="login__form-btns--odd"
            (click)="redirectToSignup()"
            tabindex="4"
          >
            Sign up
          </st-button>
          <st-button buttonModifier="rectangle" (click)="authenticateUser(loginForm)" tabindex="3">
            Log in
          </st-button>
        </div>
      </ng-container>
    </form>
  </div>
</ion-content>
